<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Hangman</title><link rel="stylesheet" href="/assets/styles.css"></head><body>
<main class="container"><h2>Two Player Hangman</h2>
<p>Player A enters word, Player B guesses letters.</p>
<div><input id="word" placeholder="Enter word (Player A)"><button onclick="setWord()">Set</button></div>
<div id="mask" style="margin-top:8px"></div>
<div style="margin-top:8px"><input id="letter" maxlength="1" placeholder="Letter"><button onclick="guess()">Guess</button></div>
<p id="res"></p>
<div style="margin-top:12px"><a class="btn" href="/">Back</a></div>
</main>
<script>
let secret='', revealed=[], mistakes=0;
function setWord(){ secret=document.getElementById('word').value.trim().toLowerCase(); if(!secret) return; revealed=secret.split('').map(c=> c===' ' ? ' ' : '_'); document.getElementById('mask').textContent=revealed.join(' '); document.getElementById('res').textContent='Player B guess now'; }
function guess(){ const l=document.getElementById('letter').value.toLowerCase(); if(!l||!secret) return; let found=false; for(let i=0;i<secret.length;i++){ if(secret[i]===l){ revealed[i]=l; found=true } } if(!found) mistakes++; document.getElementById('mask').textContent=revealed.join(' '); if(!revealed.includes('_')){ document.getElementById('res').textContent='Guesser wins'; saveScorePayload('hangman',1); } else if(mistakes>=6){ document.getElementById('res').textContent='Setter wins'; saveScorePayload('hangman',1); } }

function saveScorePayload(game, numeric){
  const token = localStorage.getItem('token');
  const scoreVal = numeric!==undefined?numeric:1;
  if(!token){ alert('Log in to save scores'); return; }
  fetch('/api/score', {
    method:'POST',
    headers:{'Content-Type':'application/json','Authorization':'Bearer '+token},
    body:JSON.stringify({game:game, score:String(scoreVal), numeric_score: Number(scoreVal)})
  }).then(r=>r.json()).then(j=>alert(j.message||JSON.stringify(j)));
}
</script></body></html>